---

---

<div data-testimonial-wrap="" class="testimonial-lines">
  <div class="testimonial-lines__controls">
    <button
      data-prev=""
      aria-label="previous testimonial"
      class="testimonial-lines__button"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="100%"
        viewbox="0 0 12 12"
        fill="none"
        class="testimonial-lines__arrow"
      >
        <path
          d="M5.26512 12L6.43721 10.7746L1.48837 5.28169V6.71831L6.45581 1.22535L5.28372 0L-2.21369e-07 6L5.26512 12ZM12 6.97183V5.02817H1.30232V6.97183H12Z"
          fill="#fefefe"></path>
      </svg>
    </button>
    <button
      data-next=""
      aria-label="next testimonial"
      class="testimonial-lines__button"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="100%"
        viewbox="0 0 12 12"
        fill="none"
        class="testimonial-lines__arrow"
      >
        <path
          d="M6.73488 12L5.56279 10.7746L10.5116 5.28169V6.71831L5.54419 1.22535L6.71628 0L12 6L6.73488 12ZM0 6.97183V5.02817H10.6977V6.97183H0Z"
          fill="#fefefe"
          "></path>
      </svg>
    </button>
  </div>
  <div class="testimonial-lines__main">
    <div class="testimonial-lines__main-details">
      <p class="testimonial-lines__p is--faded">
        <span data-current="" class="testimonial-lines__count">1</span> / <span
          data-total="">5</span
        >
      </p>
      <p class="testimonial-lines__p">What our clients say:</p>
    </div>
    <div class="testimonial-lines__collection">
      <div role="list" data-testimonial-list="" class="testimonial-lines__list">
        <div
          aria-hidden="false"
          data-testimonial-item=""
          role="listitem"
          class="testimonial-lines__item is--active"
        >
          <h3 data-testimonial-text="" class="testimonial-lines__h">
            “The service was professional, thorough, and way above my
            expectations. My car feels brand new again. I was especially
            impressed with how well he handled the pet hair! He took his time,
            paid attention to every detail, and truly went the extra mile. I
            can’t recommend him enough for anyone looking for quality, care, and
            fantastic results. I’ll definitely be using this service again!!”
          </h3>
          <div class="testimonial-lines__item-details">
            <div>
              <p data-testimonial-split="" class="testimonial-lines__p">
                Nicole Dea
              </p>
            </div>
          </div>
        </div>
        <div
          aria-hidden="true"
          data-testimonial-item=""
          role="listitem"
          class="testimonial-lines__item"
        >
          <h3 data-testimonial-text="" class="testimonial-lines__h">
            “We were recommended to JJ’s auto detailing by a friend and his
            service did not disappoint! My car is spotless. He’s a hardworking
            young kid and I definitely recommend his work”
          </h3>
          <div class="testimonial-lines__item-details">
            <div>
              <p data-testimonial-split="" class="testimonial-lines__p">
                Karen Heppell
              </p>
            </div>
          </div>
        </div>
        <div
          aria-hidden="true"
          data-testimonial-item=""
          role="listitem"
          class="testimonial-lines__item"
        >
          <h3 data-testimonial-text="" class="testimonial-lines__h">
            “Loved the work that Jo did on our van and our daughter's car.
            Looked like brand new. He loves what he does and has incredible
            attention to detail. Highly recommend without reservation. ”
          </h3>
          <div class="testimonial-lines__item-details">
            <div>
              <p data-testimonial-split="" class="testimonial-lines__p">
                Jeff Kuhn
              </p>
            </div>
          </div>
        </div>
        <div
          aria-hidden="true"
          data-testimonial-item=""
          role="listitem"
          class="testimonial-lines__item"
        >
          <h3 data-testimonial-text="" class="testimonial-lines__h">
            “My truck was a mess after a summer of camping, fishing, home
            renovations and construction debris removal. After dumping a full
            cup of coffee on the driver’s seat, I knew I needed to get the truck
            cleaned up. Josiah did a fantastic job, and made my truck look as
            clean as the day I bought it. His work was thorough , timely, and
            professional, and his rates were very competitive. I highly
            recommend JJ’s Detailing for your vehicle cleaning and detailing
            needs. Thanks, Josiah, for a great job making my truck spotless!”
          </h3>
          <div class="testimonial-lines__item-details">
            <div>
              <p data-testimonial-split="" class="testimonial-lines__p">
                Dave Loewen
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  import gsap from "gsap";
  import { SplitText } from "gsap/SplitText";

  function initLineRevealTestimonials() {
    const wraps = document.querySelectorAll("[data-testimonial-wrap]");
    if (!wraps.length) return;

    wraps.forEach((wrap) => {
      const list = wrap.querySelector("[data-testimonial-list]");
      if (!list) return;

      const items = Array.from(
        list.querySelectorAll("[data-testimonial-item]"),
      );
      if (!items.length) return;

      const btnPrev = wrap.querySelector("[data-prev]");
      const btnNext = wrap.querySelector("[data-next]");
      const elCurrent = wrap.querySelector("[data-current]");
      const elTotal = wrap.querySelector("[data-total]");

      if (elTotal) elTotal.textContent = String(items.length);

      let activeIndex = items.findIndex((el) =>
        el.classList.contains("is--active"),
      );
      if (activeIndex < 0) activeIndex = 0;

      let isAnimating = false;
      let reduceMotion = false;

      const slides = items.map((item) => ({
        item,
        image: item.querySelector("[data-testimonial-img]"),

        splitTargets: [
          item.querySelector("[data-testimonial-text]"),
          ...item.querySelectorAll("[data-testimonial-split]"),
        ].filter(Boolean),

        splitInstances: [],

        getLines() {
          return this.splitInstances.flatMap((instance) => instance.lines);
        },
      }));

      function setSlideState(slideIndex, isActive) {
        const { item } = slides[slideIndex];
        item.classList.toggle("is--active", isActive);
        item.setAttribute("aria-hidden", String(!isActive));
        gsap.set(item, {
          autoAlpha: isActive ? 1 : 0,
          pointerEvents: isActive ? "auto" : "none",
        });
      }

      function updateCounter() {
        if (elCurrent) elCurrent.textContent = String(activeIndex + 1);
      }

      // Set initial state
      slides.forEach((_, i) => setSlideState(i, i === activeIndex));
      updateCounter();

      // Handle reduced motion preference
      gsap
        .matchMedia()
        .add({ reduce: "(prefers-reduced-motion: reduce)" }, (context) => {
          reduceMotion = context.conditions.reduce;
        });

      // Create SplitText instances
      slides.forEach((slide, slideIndex) => {
        slide.splitInstances = slide.splitTargets.map((el) =>
          SplitText.create(el, {
            type: "lines",
            mask: "lines",
            linesClass: "text-line",
            autoSplit: true,
            onSplit(self) {
              if (reduceMotion) return;

              const isActive = slideIndex === activeIndex;
              gsap.set(self.lines, { yPercent: isActive ? 0 : 110 });

              if (slide.image) {
                gsap.set(slide.image, {
                  clipPath: isActive
                    ? "circle(50% at 50% 50%)"
                    : "circle(0% at 50% 50%)",
                });
              }
            },
          }),
        );
      });

      function goTo(nextIndex) {
        if (isAnimating || nextIndex === activeIndex) return;
        isAnimating = true;

        const outgoingSlide = slides[activeIndex];
        const incomingSlide = slides[nextIndex];

        const tl = gsap.timeline({
          onComplete: () => {
            setSlideState(activeIndex, false);
            setSlideState(nextIndex, true);
            activeIndex = nextIndex;
            updateCounter();
            isAnimating = false;
          },
        });

        if (reduceMotion) {
          tl.to(
            outgoingSlide.item,
            {
              autoAlpha: 0,
              duration: 0.4,
              ease: "power2",
            },
            0,
          ).fromTo(
            incomingSlide.item,
            {
              autoAlpha: 0,
            },
            {
              autoAlpha: 1,
              duration: 0.4,
              ease: "power2",
            },
            0,
          );

          return;
        }

        const outgoingLines = outgoingSlide.getLines();
        const incomingLines = incomingSlide.getLines();

        gsap.set(incomingSlide.item, { autoAlpha: 1, pointerEvents: "auto" });
        gsap.set(incomingLines, { yPercent: 110 });

        if (incomingSlide.image)
          gsap.set(incomingSlide.image, { clipPath: "circle(0% at 50% 50%)" });
        if (outgoingSlide.image)
          gsap.set(outgoingSlide.image, { clipPath: "circle(50% at 50% 50%)" });

        tl.to(
          outgoingLines,
          {
            yPercent: -110,
            duration: 0.6,
            ease: "power4.inOut",
            stagger: { amount: 0.25 },
          },
          0,
        );

        if (outgoingSlide.image) {
          tl.to(
            outgoingSlide.image,
            {
              clipPath: "circle(0% at 50% 50%)",
              duration: 0.6,
              ease: "power4.inOut",
            },
            0,
          );
        }

        tl.to(
          incomingLines,
          {
            yPercent: 0,
            duration: 0.7,
            ease: "power4.inOut",
            stagger: { amount: 0.4 },
          },
          ">-=0.3",
        );

        if (incomingSlide.image) {
          tl.to(
            incomingSlide.image,
            {
              clipPath: "circle(50% at 50% 50%)",
              duration: 0.75,
              ease: "power4.inOut",
            },
            "<",
          );
        }

        tl.set(outgoingSlide.item, { autoAlpha: 0 }, ">");
      }

      if (btnNext)
        btnNext.addEventListener("click", () =>
          goTo((activeIndex + 1) % slides.length),
        );
      if (btnPrev)
        btnPrev.addEventListener("click", () =>
          goTo((activeIndex - 1 + slides.length) % slides.length),
        );
    });
  }

  // Initialize Line Reveal Testimonials
  document.addEventListener("DOMContentLoaded", () => {
    initLineRevealTestimonials();
  });
</script>

<style>
  .testimonial-lines {
    grid-column-gap: 1.25em;
    grid-row-gap: 1.25em;
    flex-flow: wrap;
    justify-content: flex-start;
    align-items: flex-start;
    display: flex;
    position: relative;
  }

  .testimonial-lines__controls {
    grid-column-gap: 1em;
    grid-row-gap: 1em;
    flex-flow: row;
    justify-content: flex-end;
    align-items: flex-start;
    width: 33.3333%;
    display: flex;
    position: absolute;
    right: 0;
    top: 1.5rem;
  }

  .testimonial-lines__main {
    grid-column-gap: 5em;
    grid-row-gap: 5em;
    flex-flow: column;
    flex: 1;
    justify-content: flex-start;
    align-items: flex-start;
    display: flex;
  }

  .testimonial-lines__button {
    background-color: #0000;
    border: 1px solid #fefefe;
    border-radius: 0.25em;
    justify-content: center;
    align-items: center;
    width: 2.5em;
    height: 2.5em;
    padding: 0;
    display: flex;
  }

  .testimonial-lines__arrow {
    width: 0.75em;
  }

  .testimonial-lines__main-details {
    grid-column-gap: 1.5em;
    grid-row-gap: 1.5em;
    flex-flow: row;
    justify-content: flex-start;
    align-items: center;
    display: flex;
  }

  .testimonial-lines__count {
    width: 1ch;
    display: inline-block;
  }

  .testimonial-lines__p {
    margin-bottom: 0;
    font-size: 1.25em;
    line-height: 1.5;
    font-family: "futura-100", sans-serif;
    font-weight: 400;
  }

  .testimonial-lines__p.is--faded {
    opacity: 0.5;
  }

  .testimonial-lines__collection {
    width: 100%;
  }

  .testimonial-lines__list {
    width: 100%;
    display: grid;
    position: relative;
  }

  .testimonial-lines__item {
    grid-column-gap: 4em;
    grid-row-gap: 4em;
    opacity: 0;
    visibility: hidden;
    flex-flow: column;
    grid-area: 1 / 1;
    justify-content: flex-start;
    align-items: flex-start;
    width: 100%;
    display: flex;
    position: relative;
  }

  .testimonial-lines__item.is--active {
    opacity: 100;
    visibility: visible;
  }

  .testimonial-lines__h {
    letter-spacing: -0.02em;
    width: 100%;
    margin-top: 0;
    margin-bottom: 0;
    font-size: 1.5em;
    font-weight: 500;
    line-height: 1.5;
    font-family: "futura-100", sans-serif;
    font-weight: 400;
  }

  .text-line-mask {
    padding-bottom: 0.2em;
    margin-bottom: -0.2em;
  }

  .testimonial-lines__item-details {
    grid-column-gap: 1.25em;
    grid-row-gap: 1.25em;
    flex-flow: row;
    justify-content: flex-start;
    align-items: center;
    display: flex;
  }

  .testimonial-lines__item-visual {
    aspect-ratio: 1;
    border-radius: 100em;
    width: 5em;
    overflow: hidden;
  }

  .testimonial-lines__item-img {
    object-fit: cover;
    width: 100%;
    height: 100%;
  }

  .testimonial-lines {
    grid-column-gap: 3em;
    grid-row-gap: 3em;
  }

  .testimonial-lines__controls {
    width: 100%;
  }

  .testimonial-lines__main {
    grid-column-gap: 3em;
    grid-row-gap: 3em;
  }

  .testimonial-lines__item {
    grid-column-gap: 2em;
    grid-row-gap: 2em;
  }

  .testimonial-lines__item-visual {
    width: 3.5em;
  }

  @media screen and (max-width: 980px) {
    .testimonial-lines__controls {
      right: -1.5rem;
    }
  }
</style>
